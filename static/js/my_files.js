// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    var currentFilename, edit;
    currentFilename = '';
    edit = function(fname, vlink) {
      vlink = $(this).parent().children('.videolink');
      fname = vlink.html();
      if (fname.substring(0, 6) !== "<input") {
        currentFilename = fname;
        return vlink.html('<input type="text" id="rbox" autofocus="true" placeholder="' + fname + '">');
      }
    };
    $('.editbutton').click(edit);
    return $(document).on('keypress', 'input', function(event) {
      var $target;
      if (event.which === 13 || event.keycode === 13) {
        $target = $(this).parent();
        $.ajax({
          url: 'change_name/',
          type: 'POST',
          dataType: 'json',
          data: {
            'filename': currentFilename,
            'newname': this.value
          },
          success: function(json) {
            return $target.html(json.response);
          },
          error: function(xhr, json) {
            return alert(xhr.status + '. Info: ' + json.error);
          }
        });
        return event.preventDefault();
      }
    });
  });

}).call(this);
